@using System.Data;
@model DataTable

@{
    ViewBag.Title = "当日客房数据导入";
}

@section featured {
    <section class="featured">
        <div class="content-wrapper">
            <hgroup class="title">
                <h1>@ViewBag.Title  </h1>
            </hgroup>
        </div>
    </section>
}

<div class="panel panel-default">
    <div class="panel-heading">
        IMPORT BOOKING DATA
    </div>
    <div class="panel-body">
        @if (!ViewData.ModelState.IsValid)
        {
            <div class="alert alert-danger">
                @Html.ValidationSummary()
            </div>
        }

        @if (Model == null && string.IsNullOrWhiteSpace(ViewBag.SuccessMessage))
        {            
            using (Html.BeginForm("Import", "Tool", FormMethod.Post, new { role = "form", enctype = "multipart/form-data" }))
            {                
                @Html.AntiForgeryToken()

                <div class="col-md-10">
                    <input type="file" name="file" />
                </div>
                <button type="submit" class="btn btn-success">预 览</button>
            }
        }
        else if (!string.IsNullOrWhiteSpace(ViewBag.SuccessMessage))
        {
            <div class="alert alert-success">
                @ViewBag.SuccessMessage
            </div>
        }
        else
        {
            <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                <thead>
                    <tr>
                        @foreach (var t in Model.Columns)
                        {
                            <th>@t.ToString()</th>
                        }
                    </tr>
                </thead>
                <tbody>
                    @foreach (DataRow t in Model.Rows)
                    {
                        <tr>
                            @for (int i = 0; i < Model.Columns.Count; i++ )
                            {
                                <td>@t[i]</td>
                            }
                        </tr>                    
                    }
                </tbody>
            </table>
            
            using (Html.BeginForm("Import", "Tool", FormMethod.Post, new { role = "form" }))
            {
                @Html.AntiForgeryToken()
                <div style="margin:auto; text-align:center;">
                    <input type="hidden" name="path" value="@ViewBag.path" />
                    <button type="button" class="btn btn-success" onclick="javastript: history.go(-1);" style="margin:auto;">返 回</button>
                    <button type="submit" class="btn btn-success" style="margin:auto;">导 入</button>
                </div>
            }
            
            <script>
                $(document).ready(function () {
                    $('#dataTables-example').DataTable({
                        "responsive": false,
                        "paging": true,
                        "ordering": true,
                        "info": false,
                        "searching": false,
                        "pageLength": 50,
                    });
                });
            </script>
        }


    </div>
    <!-- /.panel-body -->
    <div class="panel-footer">
        &nbsp;
    </div>
</div>

<script type="text/javascript">


</script>